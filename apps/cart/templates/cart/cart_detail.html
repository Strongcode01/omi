{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/cart_detail.css' %}">
<style>
  :root {
    --omi-neon-blue: #00ade7;
    --omi-d-blue: #001a6f;
    --omi-neon-pink: #ff13e0;
    --omi-d-neon-pink: #6a0069;
    --omi-dark-bg: #000;
    --omi-text-strong: #fce6ff;
    --omi-button: #2c012b;
  }

  .cart-container {
    display: flex;
    justify-content: center;
    padding: 2rem;
    background-color: var(--omi-dark-bg);
    color: var(--omi-text-strong);
  }

  .cart-box {
    
    padding: 2rem;
    width: 100%;
    max-width: 80%;
    border-radius: 8px;
    box-shadow: 0 0 10px var(--omi-d-neon-pink);
  }

  .cart-box h2 {
    color: var(--omi-neon-pink);
    margin-bottom: 1.5rem;
    text-align: center;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1rem;
  }

  thead {
    background: rgba(106, 0, 105, 0.6);
    color: var(--omi-text-strong);
  }

  th, td {
    padding: 0.75rem;
    text-align: center;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  td input[type="number"] {
    width: 60px;
    padding: 0.4rem;
    background: rgba(75, 0, 82, 0.582);
    border: 1px solid var(--omi-neon-pink);
    color: var(--omi-text-strong);
    text-align: center;
    border-radius: 4px;
  }

  .qty-buttons a {
    font-weight: bold;
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    text-decoration: none;
    font-size: 1.2rem;
  }

  .qty-buttons a.minus {
    color: var(--omi-neon-pink);
  }

  .qty-buttons a.plus {
    color: var(--omi-neon-blue);
  }

  .btn-update {
    border: none;
    background: transparent;
    color: var(--omi-text-strong);
    font-size: 0.8rem;
    cursor: pointer;
    padding: 0 0.5rem;
  }

  .btn-update:hover {
    color: var(--omi-neon-blue);
    background-color: transparent;
  }

  .total {
    text-align: right;
    font-size: 1.3rem;
    margin-top: 1rem;
  }

  .checkout-btn {
    /* display: inline-block; */
    background: var(--omi-neon-blue);
    color: #000;
    padding: 0.7rem 1.2rem;
    border-radius: 4px;
    box-shadow: 0 0 6px var(--omi-neon-blue);
    text-decoration: none;
    float: right;
    margin-top: 1rem;
  }
  .checkout-btn:hover {
    background-color: #270f26;
    color: #fff;
  }

  .empty-message {
    text-align: center;
    font-size: 1.2rem;
    color: var(--omi-text-strong);
  }

  .empty-message a {
    color: var(--omi-neon-blue);
    text-decoration: underline;
  }
</style>
{% endblock %}

{% block title %}Your Cart{% endblock %}

{% block content %}
<div class="cart-container">
  <div class="cart-box">
    <h2>Your Selected Items for Shopping</h2>
    <center><p>Update the Items Quantities</p></center>
    {% if items %}
      <table>
        <thead>
          <tr>
            <th>Product</th>
            <th>Quantity</th>
            <th>Unit Price</th>
            <th>Subtotal</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
            <tr>
              <td>{{ item.product.title }}</td>
              <td>
                <div class="qty-buttons">
                  <a href="{% url 'cart:cart_deduct' item.product.pk %}" class="minus">-</a>
                  <form action="{% url 'cart:cart_update' item.product.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <input type="number" name="quantity" value="{{ item.quantity }}" min="0">
                    <button type="submit" class="btn-update">ðŸ”„update</button>
                  </form>
                  <a href="{% url 'cart:cart_add' item.product.pk %}" class="plus">+</a>
                </div>
              </td>
              <td>â‚¦{{ item.product.price }}</td>
              <td>â‚¦{{ item.subtotal }}</td>
              <td>
                <a href="{% url 'cart:cart_remove' item.product.pk %}" style="color: var(--omi-neon-pink);">Remove</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <div class="total">
        Total: â‚¦{{ total }}
      </div>
      <a href="{% url 'orders:order_create' %}" class="checkout-btn">Proceed to Checkout</a>
    {% else %}
      <div class="empty-message">
        Your cart is empty. <a href="{% url 'products:product_list' %}">Browse products</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/cart_detail.js' %}" defer></script>
{% endblock %}
